<!DOCTYPE html>
<html>

  <head>
    
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Daniel  Da Costa


  | Recommendation System

</title>
<meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üî•</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/projects/17_project/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://DanielDaCosta.github.io/">
       <span class="font-weight-bold">Daniel</span>   Da Costa
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item ">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                projects
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/resume/">
                resume
                
              </a>
          </li>
          
          
          
          
            <div class="toggle-container">
              <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">

  <header class="post-header">
    <h1 class="post-title">Recommendation System</h1>
    <p class="post-description">The project's goal is to create diverse recommendation systems that predict user-item ratings</p>
  </header>

  <article>
    <p><em>You can find the full code in <a href="https://github.com/DanielDaCosta/recommendation-system" target="_blank" rel="noopener noreferrer">here</a></em></p>

<h1 id="recommendation-system">Recommendation System</h1>

<p>The project consists of building  different types of recommendation systems using the <a href="https://www.yelp.com/dataset" target="_blank" rel="noopener noreferrer">Yelp</a> dataset to predict the ratings/stars for given user ids and business ids.</p>

<h2 id="dataset">Dataset</h2>

<p>Original Yelp review dataset with some filters.</p>

<ol>
  <li>yelp_train.csv: the training data, which only include the columns: user_id, business_id, and stars.</li>
  <li>yelp_val.csv: the validation data, which are in the same format as training data.</li>
  <li>We are not sharing the test dataset.</li>
  <li>review_train.json: review data only for the training pairs (user, business)</li>
  <li>user.json: all user metadata</li>
  <li>business.json: all business metadata, including locations, attributes, and categories d. checkin.json: user checkins for individual businesses</li>
  <li>tip.json: tips (short reviews) written by a user about a business</li>
  <li>photo.json: photo data, including captions and classifications</li>
</ol>

<h2 id="models">Models</h2>

<h3 id="item-based-cf-recommendation-system-with-pearson-similarity">Item-based CF recommendation system with Pearson similarity</h3>
<p>The idea behind a item-to-item collaborative filtering is to rather than matching similar users, match user‚Äôs rated items to similar items. In practice, often leads to faster online systems and better recommendations
Similarities between pairs of items i and j are computed off-line.
Predict rating of user ‚Äúa‚Äù on item ‚Äúi‚Äù with a simple weighted average</p>

<h3 id="results">Results</h3>
<p>File: code/competition.py
RMSE: 1.0575379905</p>

<h2 id="model-based">Model-based</h2>
<p>In this project, I have implemented a Model-Based approach to predict user ratings. To achieve this, I utilized the powerful <strong>XGBoost</strong> model, which I fine-tuned through <strong>RandomizedSearchCV</strong> with a thoughtfully selected set of parameters. This rigorous tuning process aimed to optimize the model‚Äôs performance and enhance its predictive capabilities.</p>

<h3 id="fine-tuning">Fine-tuning</h3>
<p>The hyperparameters that have been tuned were</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> {'max_depth': [7, 8, 9], 'learning_rate': [0.01, 0.03 ,0.05, 0.07, 0.1], 'n_estimators': [512], 'colsample_bytree': np.arange(0.7, 1, 0.1), 'colsample_bylevel': np.arange(0 7, 1.0, 0.1).}
</code></pre></div></div>

<p>I employed a <strong>Model Stacking</strong> technique with Cross Validation to train the model, generating 10 distinct models. To arrive at the final rating prediction, I averaged the individual predictions from each model.</p>

<p>For consistency and reproducibility, I saved all 10 models in the model/ folder and utilized the joblib library to read them for making predictions.</p>

<p>Additionally, I experimented with combining user-based, item-based, and model-based predictions using both switching and weighting techniques. Despite exploring these approaches, the model-based prediction consistently outperformed the other two methods.</p>

<h3 id="features">Features</h3>

<p>In this project, significant effort was dedicated to feature engineering to optimize the predictive performance and minimize the Root Mean Squared Error (RMSE). To achieve this, a diverse set of features was explored, combining raw data from both the User and Business datasets with newly created features. The following features were developed:</p>

<ol>
  <li>
    <p>n_attributes: The number of attributes associated with each business_id, providing additional information about the businesses‚Äô characteristics.</p>
  </li>
  <li>
    <p>average_stars_user: The average star rating given by each user, offering insights into their general reviewing behavior.</p>
  </li>
  <li>
    <p>avg_star_category: The average star rating given by each user for businesses falling within specific categories, enabling the model to capture preferences across different types of businesses.</p>
  </li>
  <li>
    <p>The businesses were categorized into the following categories: [‚Äòrestaurants‚Äô, ‚Äòshopping‚Äô, ‚Äòfood‚Äô, ‚Äòbeauty‚Äô, ‚Äòhealth‚Äô, ‚Äòhome‚Äô, ‚Äònightlife‚Äô, ‚Äòautomotive‚Äô, ‚Äòbars‚Äô, ‚Äòlocal‚Äô].</p>
  </li>
  <li>
    <p>yelping_since_year: The year of each review, potentially uncovering trends or changes in reviewing habits over time.</p>
  </li>
  <li>
    <p>review_count_business: The average number of reviews per business, which may reveal patterns related to business popularity or activity.</p>
  </li>
</ol>

<h3 id="results-1">Results</h3>
<ul>
  <li>Files: competion.py and train.py</li>
  <li>RMSE: 0.9772904711772428</li>
</ul>

  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    ¬© Copyright 2023 Daniel  Da Costa.
    Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>.

    
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
