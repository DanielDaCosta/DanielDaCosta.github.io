<!DOCTYPE html>
<html>

  <head>
    
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Daniel  Da Costa


  | Heart Disease Classification

</title>
<meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üî•</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/projects/5_project/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://DanielDaCosta.github.io/">
       <span class="font-weight-bold">Daniel</span>   Da Costa
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item ">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                projects
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/resume/">
                resume
                
              </a>
          </li>
          
          
          
          
            <div class="toggle-container">
              <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">

  <header class="post-header">
    <h1 class="post-title">Heart Disease Classification</h1>
    <p class="post-description">Machine Learning Classification Model</p>
  </header>

  <article>
    <p><em>You can find the full code in <a href="https://github.com/DanielDaCosta/HeartDisease-Classification" target="_blank" rel="noopener noreferrer">here</a></em></p>

<p>Classification model built based on <code class="language-plaintext highlighter-rouge">Mission_Prediction_Dataset.csv</code> data that can predict the presence of a disease in the patient. 
Model created as part of CYBERLABS Mission: Disease Classification.</p>

<h2 id="requirements">Requirements</h2>
<p>Install the following packages: <code class="language-plaintext highlighter-rouge">pip install -r requirements.txt</code></p>
<ul>
  <li>Python 3.7</li>
  <li>Numpy: V1.16.4</li>
  <li>Pandas: V0.24.2</li>
  <li>Seaborn: V0.9.0</li>
  <li>Keras: V2.2.4</li>
  <li>Keras-Applications: V1.0.8</li>
  <li>Keras-Preprocessing: V1.1.0</li>
  <li>Scikit-learn: V0.21..2</li>
  <li>Scipy: V1.3.0</li>
  <li>Matplotlib: V3.1.0</li>
</ul>

<h2 id="developing-process">Developing Process</h2>
<h3 id="preprocessing">Preprocessing</h3>
<p>The first step was to analyze the dataset. After verifying the non existence of missing values, the following step was to 
understand how the features were distributed. As some of the variables had similar distributions the dataset was reorganized
so that these features would be side by side.</p>

<p>The output histogram showed that the data was well balanced: 54.45% for sick people and 45.54% for non sick.</p>

<p>In order to analyze each feature contribution to the output, the correlation matrix was plotted. Every feature was correlated
to the output and there wasn‚Äôt any multicollinearity problem. On the other hand, outliers were detected through a scatter plot
of the data. For a more precise detection, Z-score was used in order to find and remove them.</p>

<p>Since the features have different scales and in order to make the training less sensitive to the scales of variables,
the dataset was normalized. For those with gaussian distributions the best way to rescale them was using standardization.
The binary data did not need normalization so its values did not change. For the rest of the data, they were normalized using a MinMaxScale function.</p>

<h3 id="creating-ml-model">Creating ML Model</h3>

<h4 id="neural-network">Neural Network</h4>

<p>For this problem a Neural Network classification model was used. Because of its versatility and also the fact that I was
already familiar with this Machine Learning Model, it ended up being chosen. Due to the complexity of the data, 
with multiples variables, a Multilayer Perceptron with two hidden layers was the best configuration to use.</p>

<p>The inputs range were basically between -1 and 1 (some values were higher due to standardization), so for the hidden layers‚Äô 
activation functions the ‚Äòtanh‚Äô function was chosen. Since it was a classification problem a ‚Äòsigmoid‚Äô was used in output
layer.</p>

<p>To prevent overfitting methods such as: Droup out and L1 and L2 Regularization, were used, but the result was not good 
enough, due to the small neural network configuration (only 7 neurons in each layer). The best result was obtained using 
the early stopping method. The model efficiency was measured using accuracy metric, as it was asked.</p>

<p>30% of the data was used to test the model, 10% as validation set and the rest was used for training.</p>

<p>The model has an accuracy an average accuracy 84,366% on the test set and 87,55% on the train set. 
It‚Äôs a reasonable result but not the best one. The model showed itself to be difficult to optimize since the neural
network was small and so was the dataset.</p>

<h4 id="support-vector-machines">Support Vector Machines</h4>

<p>In order to compare the obtained result using the Neural Network method, another ML model was used. The chosen one was
Support Vector Machine modes. SVM was chosen since iis capable of doing classification, has an easy implementation and 
also due to the fact that the input data is the same type of the one used in the last model. Using 30% of the data to 
test the model and the rest for training.</p>

<p>Because of data‚Äôs complexity and since the target has only two classes, a ‚Äòsigmoid‚Äô was used as the kernel. The other ones:
linear, gaussian and polynomial were also tested, but they did not give the best result.</p>

<p>The model has an average accuracy of 84,36%, almost the same obtained with the last model, which shows the consistency of 
the results.</p>

<h2 id="outputtxt-file">Output.txt file</h2>

<p>This file contains a list of ten prediction results of both models and also an average accuracy for each of them.</p>

<h2 id="execution">Execution</h2>

<p>The path to the csv file: <em>Mission_Prediction_Dataset.csv</em>, should be added in the function pd.read_csv(‚Äú<em>Add path here</em>‚Äù), 
line 21. The python file ‚ÄòDaniel_Prediction.py‚Äô just have to be executed with all the needed libraries, Python 3.7 was used. The output contains the following figures, 16 in total. Comment the last line of the code, line 166, if the figures do not want to be displayed:</p>

<ul>
  <li>Distributions graphs of each feature (thirtenn figures)</li>
  <li>Histogram of the output data</li>
  <li>Correlation Matrix</li>
  <li>Neural Network Loss function of training and test sets</li>
</ul>

<p>The Neural Networks results (confusion Matrix and accuracy) and SVM results (confusion Matrix and accuracy) will be 
shown on the screen, in that order.</p>

<h2 id="acknowledgemetns">Acknowledgemetns</h2>

<p>The dataset came from a Kaggle competition that can be foud here <a href="https://www.kaggle.com/cdabakoglu/heart-disease-classifications-machine-learning" target="_blank" rel="noopener noreferrer">here</a>.</p>

  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    ¬© Copyright 2023 Daniel  Da Costa.
    Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>.

    
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
